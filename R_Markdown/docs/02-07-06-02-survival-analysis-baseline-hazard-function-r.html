<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head>

<meta charset="utf-8">
<meta name="generator" content="quarto-1.4.553">

<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">


<title>Survival Analysis</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1em; /* quarto-specific, see https://github.com/quarto-dev/quarto-cli/issues/4556 */ 
  vertical-align: middle;
}
/* CSS for syntax highlighting */
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
  }
pre.numberSource { margin-left: 3em;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
</style>


<script src="site_libs/quarto-nav/quarto-nav.js"></script>
<script src="site_libs/clipboard/clipboard.min.js"></script>
<script src="site_libs/quarto-search/autocomplete.umd.js"></script>
<script src="site_libs/quarto-search/fuse.min.js"></script>
<script src="site_libs/quarto-search/quarto-search.js"></script>
<meta name="quarto:offset" content="./">
<link href="./02-07-06-03-survival-analysis-causal-effects-r.html" rel="next">
<link href="./02-07-06-01-survival-analysis-standard-joint-model-r.html" rel="prev">
<script src="site_libs/quarto-html/quarto.js"></script>
<script src="site_libs/quarto-html/popper.min.js"></script>
<script src="site_libs/quarto-html/tippy.umd.min.js"></script>
<script src="site_libs/quarto-html/anchor.min.js"></script>
<link href="site_libs/quarto-html/tippy.css" rel="stylesheet">
<link href="site_libs/quarto-html/quarto-syntax-highlighting.css" rel="stylesheet" id="quarto-text-highlighting-styles">
<script src="site_libs/bootstrap/bootstrap.min.js"></script>
<link href="site_libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="site_libs/bootstrap/bootstrap.min.css" rel="stylesheet" id="quarto-bootstrap" data-mode="light">
<script id="quarto-search-options" type="application/json">{
  "location": "sidebar",
  "copy-button": false,
  "collapse-after": 3,
  "panel-placement": "start",
  "type": "textbox",
  "limit": 50,
  "keyboard-shortcut": [
    "f",
    "/",
    "s"
  ],
  "language": {
    "search-no-results-text": "No results",
    "search-matching-documents-text": "matching documents",
    "search-copy-link-title": "Copy link to search",
    "search-hide-matches-text": "Hide additional matches",
    "search-more-match-text": "more match in this document",
    "search-more-matches-text": "more matches in this document",
    "search-clear-button-title": "Clear",
    "search-text-placeholder": "",
    "search-detached-cancel-button-title": "Cancel",
    "search-submit-button-title": "Submit",
    "search-label": "Search"
  }
}</script>

  <script src="https://polyfill.io/v3/polyfill.min.js?features=es6"></script>
  <script src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-chtml-full.js" type="text/javascript"></script>

<script type="text/javascript">
const typesetMath = (el) => {
  if (window.MathJax) {
    // MathJax Typeset
    window.MathJax.typeset([el]);
  } else if (window.katex) {
    // KaTeX Render
    var mathElements = el.getElementsByClassName("math");
    var macros = [];
    for (var i = 0; i < mathElements.length; i++) {
      var texText = mathElements[i].firstChild;
      if (mathElements[i].tagName == "SPAN") {
        window.katex.render(texText.data, mathElements[i], {
          displayMode: mathElements[i].classList.contains('display'),
          throwOnError: false,
          macros: macros,
          fleqn: false
        });
      }
    }
  }
}
window.Quarto = {
  typesetMath
};
</script>

</head>

<body class="nav-sidebar docked nav-fixed">

<div id="quarto-search-results"></div>
  <header id="quarto-header" class="headroom fixed-top quarto-banner">
    <nav class="navbar navbar-expand-lg " data-bs-theme="dark">
      <div class="navbar-container container-fluid">
      <div class="navbar-brand-container mx-auto">
    <a class="navbar-brand" href="./index.html">
    <span class="navbar-title">Survival Analysis</span>
    </a>
  </div>
          <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbarCollapse" aria-controls="navbarCollapse" aria-expanded="false" aria-label="Toggle navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">
  <span class="navbar-toggler-icon"></span>
</button>
          <div class="collapse navbar-collapse" id="navbarCollapse">
            <ul class="navbar-nav navbar-nav-scroll me-auto">
  <li class="nav-item compact">
    <a class="nav-link" href="https://sites.google.com/view/r-data-sci-env/home"> <i class="bi bi-house" role="img">
</i> 
<span class="menu-text"></span></a>
  </li>  
</ul>
            <ul class="navbar-nav navbar-nav-scroll ms-auto">
  <li class="nav-item compact">
    <a class="nav-link" href="https://github.com/zia207/r-colab"> <i class="bi bi-github" role="img">
</i> 
<span class="menu-text"></span></a>
  </li>  
  <li class="nav-item compact">
    <a class="nav-link" href="https://www.linkedin.com/in/zia-ahmed207"> <i class="bi bi-linkedin" role="img">
</i> 
<span class="menu-text"></span></a>
  </li>  
  <li class="nav-item compact">
    <a class="nav-link" href="./zia207@gmail.com"> 
<span class="menu-text"></span></a>
  </li>  
</ul>
          </div> <!-- /navcollapse -->
          <div class="quarto-navbar-tools">
</div>
      </div> <!-- /container-fluid -->
    </nav>
  <nav class="quarto-secondary-nav">
    <div class="container-fluid d-flex">
      <button type="button" class="quarto-btn-toggle btn" data-bs-toggle="collapse" data-bs-target=".quarto-sidebar-collapse-item" aria-controls="quarto-sidebar" aria-expanded="false" aria-label="Toggle sidebar navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">
        <i class="bi bi-layout-text-sidebar-reverse"></i>
      </button>
        <nav class="quarto-page-breadcrumbs" aria-label="breadcrumb"><ol class="breadcrumb"><li class="breadcrumb-item"><a href="./02-07-06-00-survival-analysis-joint-modeling-introduction-r.html"><strong>Joint Modeling</strong></a></li><li class="breadcrumb-item"><a href="./02-07-06-02-survival-analysis-baseline-hazard-function-r.html">Baseline Hazard Function of Joint Models</a></li></ol></nav>
        <a class="flex-grow-1" role="button" data-bs-toggle="collapse" data-bs-target=".quarto-sidebar-collapse-item" aria-controls="quarto-sidebar" aria-expanded="false" aria-label="Toggle sidebar navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">      
        </a>
      <button type="button" class="btn quarto-search-button" aria-label="" onclick="window.quartoOpenSearch();">
        <i class="bi bi-search"></i>
      </button>
    </div>
  </nav>
</header>
<!-- content -->
<div id="quarto-content" class="quarto-container page-columns page-rows-contents page-layout-article page-navbar">
<!-- sidebar -->
  <nav id="quarto-sidebar" class="sidebar collapse collapse-horizontal quarto-sidebar-collapse-item sidebar-navigation docked overflow-auto">
    <div class="pt-lg-2 mt-2 text-center sidebar-header">
      <a href="./index.html" class="sidebar-logo-link">
      <img src="./Image/chapter_logo_survival_analysis_r.png" alt="" class="sidebar-logo py-0 d-lg-inline d-none">
      </a>
      </div>
        <div class="mt-2 flex-shrink-0 align-items-center">
        <div class="sidebar-search">
        <div id="quarto-search" class="" title="Search"></div>
        </div>
        </div>
    <div class="sidebar-menu-container"> 
    <ul class="list-unstyled mt-1">
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-1" aria-expanded="true">
 <span class="menu-text"><strong>Survival Analysis</strong></span></a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-1" aria-expanded="true" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-1" class="collapse list-unstyled sidebar-section depth1 show">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./index.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Introduction</span></a>
  </div>
</li>
      </ul>
  </li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-2" aria-expanded="true">
 <span class="menu-text"><strong>Non-Parametric Methods</strong></span></a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-2" aria-expanded="true" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-2" class="collapse list-unstyled sidebar-section depth1 show">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./02-07-01-00-survival-analysis-non-parametric-introduction-r.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Introduction to Non-Parametric Survival Models</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./02-07-01-01-survival-analysis-kaplan-meier-r.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Kaplan-Meier Estimator</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./02-07-01-02-survival-analysis-nelson-aalen-r.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Nelson-Aalen Estimator</span></a>
  </div>
</li>
      </ul>
  </li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-3" aria-expanded="true">
 <span class="menu-text"><strong>Semi-Parametric Methods</strong></span></a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-3" aria-expanded="true" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-3" class="collapse list-unstyled sidebar-section depth1 show">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./02-07-02-00-survival-analysis-semi-parametric-introduction-r.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Introduction to Semi-Parametric Survival Models</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./02-07-02-01-survival-analysis-cox-regression-r.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Cox Proportional Hazards Model</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./02-07-02-02-survival-analysis-time-dependent-covariates-r.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Survival Analysis with Time-Dependent Covariates</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./02-07-02-03-survival-analysis-stratified-cox-model-r.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Stratified Cox Model</span></a>
  </div>
</li>
      </ul>
  </li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-4" aria-expanded="true">
 <span class="menu-text"><strong>Parametric Methods</strong></span></a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-4" aria-expanded="true" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-4" class="collapse list-unstyled sidebar-section depth1 show">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./02-07-03-00-survival-analysis-parametric-introduction-r.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Introduction to Parametric Survival Models</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./02-07-03-01-survival-analysis-exponential-model-r.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Exponential Survival Model</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./02-07-03-02-survival-analysis-weibull-model-r.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Weibull Model for Survival Analysis</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./02-07-03-03-survival-analysis-log-normal-model-r.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Log-Normal Survival Model f</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./02-07-03-04-survival-analysis-log-logistic-model-r.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Log-Logistic Survival Model</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./02-07-03-05-survival-analysis-generalized-gamma-model-r.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Generalized Gamma Survival Model</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./02-07-03-06-survival-analysis-gompertz-model-r.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Gompertz Survival Model</span></a>
  </div>
</li>
      </ul>
  </li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-5" aria-expanded="true">
 <span class="menu-text"><strong>Recurrent Event Models</strong></span></a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-5" aria-expanded="true" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-5" class="collapse list-unstyled sidebar-section depth1 show">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./02-07-04-00-survival-analysis-recurrent-event-models-r.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Introduction to Recurrent Event Models</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./02-07-04-01-survival-analysis-andersen-gill-model-r.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Andersen-Gill (AG) Model</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./02-07-04-02-survival-analysis-prentice-williams-peterson-model-r.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Prentice-Williams-Peterson (PWP) Models</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./02-07-04-03-survival-analysis-frailty-models-r.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Frailty Models</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./02-07-04-04-survival-analysis-marginal-models-r.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Marginal Models</span></a>
  </div>
</li>
      </ul>
  </li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-6" aria-expanded="true">
 <span class="menu-text"><strong>Risk Regression</strong></span></a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-6" aria-expanded="true" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-6" class="collapse list-unstyled sidebar-section depth1 show">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./02-07-05-00-survival-analysi-risk-regression-introduction-r.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Introduction to Risk Regression</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./02-07-05-01-survival-analysis-cause-specific-hazard-regression.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Cause-Specific Hazard Regression</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./02-07-05-02-survival-analysis-subdistribution-hazard-regression.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Subdistribution Hazard Regression (Fine-Gray Model)</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./02-07-05-03-survival-analysis-absolute-risk-regression-r.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Absolute Risk Regression (Direct CIF Modeling)</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./02-07-05-04-survival-analysis-aalen-model-r.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Aalen’s Additive Regression Model</span></a>
  </div>
</li>
      </ul>
  </li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-7" aria-expanded="true">
 <span class="menu-text"><strong>Joint Modeling</strong></span></a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-7" aria-expanded="true" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-7" class="collapse list-unstyled sidebar-section depth1 show">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./02-07-06-00-survival-analysis-joint-modeling-introduction-r.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Introduction to Joint Modeling in Survival Analysis</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./02-07-06-01-survival-analysis-standard-joint-model-r.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Standard (Shared Random Effects) Joint Model</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./02-07-06-02-survival-analysis-baseline-hazard-function-r.html" class="sidebar-item-text sidebar-link active">
 <span class="menu-text">Baseline Hazard Function of Joint Models</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./02-07-06-03-survival-analysis-causal-effects-r.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Causal Effects from Joint Models</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./02-07-06-04-survival-analysis-competing-risks-r.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Competing Risks of Joint Models</span></a>
  </div>
</li>
      </ul>
  </li>
    </ul>
    </div>
</nav>
<div id="quarto-sidebar-glass" class="quarto-sidebar-collapse-item" data-bs-toggle="collapse" data-bs-target=".quarto-sidebar-collapse-item"></div>
<!-- margin-sidebar -->
    <div id="quarto-margin-sidebar" class="sidebar margin-sidebar">
        <nav id="TOC" role="doc-toc" class="toc-active">
    <h2 id="toc-title">Contents</h2>
   
  <ul>
  <li><a href="#baseline-hazard-function-of-joint-models" id="toc-baseline-hazard-function-of-joint-models" class="nav-link active" data-scroll-target="#baseline-hazard-function-of-joint-models">6.2 Baseline Hazard Function of Joint Models</a>
  <ul>
  <li><a href="#how-is-this-different-from-a-standard-shared-random-effects-joint-model" id="toc-how-is-this-different-from-a-standard-shared-random-effects-joint-model" class="nav-link" data-scroll-target="#how-is-this-different-from-a-standard-shared-random-effects-joint-model">How is this different from a “standard” shared random effects joint model?</a></li>
  <li><a href="#implementing-different-baseline-hazard-specifications-in-r" id="toc-implementing-different-baseline-hazard-specifications-in-r" class="nav-link" data-scroll-target="#implementing-different-baseline-hazard-specifications-in-r">Implementing Different Baseline Hazard Specifications in R</a>
  <ul class="collapse">
  <li><a href="#install-required-r-packages" id="toc-install-required-r-packages" class="nav-link" data-scroll-target="#install-required-r-packages">Install Required R Packages</a></li>
  </ul></li>
  </ul></li>
  <li><a href="#install-missing-packages" id="toc-install-missing-packages" class="nav-link" data-scroll-target="#install-missing-packages">Install missing packages</a>
  <ul>
  <li><a href="#load-packages" id="toc-load-packages" class="nav-link" data-scroll-target="#load-packages">Load Packages</a></li>
  <li><a href="#load-data" id="toc-load-data" class="nav-link" data-scroll-target="#load-data">Load data</a></li>
  <li><a href="#fit-a-longitudinal-submodel" id="toc-fit-a-longitudinal-submodel" class="nav-link" data-scroll-target="#fit-a-longitudinal-submodel">Fit a longitudinal submodel</a></li>
  <li><a href="#fit-a-cox-model-for-the-event-process" id="toc-fit-a-cox-model-for-the-event-process" class="nav-link" data-scroll-target="#fit-a-cox-model-for-the-event-process">Fit a Cox model for the event process</a></li>
  <li><a href="#different-baseline-hazard-specifications" id="toc-different-baseline-hazard-specifications" class="nav-link" data-scroll-target="#different-baseline-hazard-specifications">Different Baseline Hazard Specifications</a>
  <ul class="collapse">
  <li><a href="#penalized-b-splines-quadratic-on-original-time-scale---default" id="toc-penalized-b-splines-quadratic-on-original-time-scale---default" class="nav-link" data-scroll-target="#penalized-b-splines-quadratic-on-original-time-scale---default">Penalized B-splines (Quadratic, on Original Time Scale) - Default</a></li>
  <li><a href="#natural-cubic-splines-on-logtime" id="toc-natural-cubic-splines-on-logtime" class="nav-link" data-scroll-target="#natural-cubic-splines-on-logtime">Natural Cubic Splines on Log(Time)</a></li>
  <li><a href="#piecewise-constant-hazard" id="toc-piecewise-constant-hazard" class="nav-link" data-scroll-target="#piecewise-constant-hazard">Piecewise Constant Hazard</a></li>
  <li><a href="#piecewise-linear-hazard-on-log-time" id="toc-piecewise-linear-hazard-on-log-time" class="nav-link" data-scroll-target="#piecewise-linear-hazard-on-log-time">Piecewise Linear Hazard (on Log Time)</a></li>
  <li><a href="#weibull-baseline-hazard" id="toc-weibull-baseline-hazard" class="nav-link" data-scroll-target="#weibull-baseline-hazard">Weibull Baseline Hazard</a></li>
  <li><a href="#stratified-baseline-hazards" id="toc-stratified-baseline-hazards" class="nav-link" data-scroll-target="#stratified-baseline-hazards">Stratified Baseline Hazards</a></li>
  <li><a href="#summary-table-of-options" id="toc-summary-table-of-options" class="nav-link" data-scroll-target="#summary-table-of-options">Summary Table of Options</a></li>
  </ul></li>
  <li><a href="#practical-tips" id="toc-practical-tips" class="nav-link" data-scroll-target="#practical-tips">Practical Tips</a></li>
  <li><a href="#summary-and-conclusion" id="toc-summary-and-conclusion" class="nav-link" data-scroll-target="#summary-and-conclusion">Summary and Conclusion</a></li>
  <li><a href="#resources" id="toc-resources" class="nav-link" data-scroll-target="#resources">Resources</a></li>
  </ul></li>
  </ul>
</nav>
    </div>
<!-- main -->
<main class="content quarto-banner-title-block" id="quarto-document-content">




<div>

</div>
<div class="quarto-layout-panel" data-layout-ncol="3">
<div class="quarto-layout-row">
<div class="quarto-layout-cell" style="flex-basis: 33.3%;justify-content: center;">
<div class="quarto-figure quarto-figure-left">
<figure class="figure">
<p><a href="https://www.buffalo.edu/renew.html"><img src="Image/RENEW_logo.png" class="img-fluid quarto-figure quarto-figure-left figure-img"></a></p>
</figure>
</div>
</div>
<div class="quarto-layout-cell" style="flex-basis: 33.3%;justify-content: center;">
<div class="quarto-figure quarto-figure-right">
<figure class="figure">
<p><a href="https://github.com/zia207/Survival_Analysis_R/tree/main/Notebook/02_07_06_02_survival_analysis_baseline_hazard_function_r.ipynb"><img src="Image/github_R.png" class="img-fluid quarto-figure quarto-figure-right figure-img" width="200"></a></p>
</figure>
</div>
</div>
<div class="quarto-layout-cell" style="flex-basis: 33.3%;justify-content: center;">
<div class="quarto-figure quarto-figure-right">
<figure class="figure">
<p><a href="https://github.com/zia207/Survival_Analysis_Python/tree/main/Notebook/02_07_06_02_survival_analysis_baseline_hazard_function_python.ipynb"><img src="Image/github_Python.png" class="img-fluid quarto-figure quarto-figure-right figure-img" width="200"></a></p>
</figure>
</div>
</div>
</div>
</div>
<section id="baseline-hazard-function-of-joint-models" class="level1 unnumbered">
<h1 class="unnumbered">6.2 Baseline Hazard Function of Joint Models</h1>
<p>In <strong>joint models</strong> for longitudinal and time-to-event data, we simultaneously model:</p>
<ul>
<li>A <strong>longitudinal submodel</strong> (e.g., CD4 cell count over time),</li>
<li>An <strong>event submodel</strong> (e.g., time to death).</li>
</ul>
<p>The event submodel is typically a <strong>relative risk (Cox-type) model</strong> of the form:</p>
<p><span class="math display">\[
h_i(t) = h_0(t) \exp\bigl( \mathbf{w}_i^\top \boldsymbol{\alpha} + \text{association terms} \bigr)
\]</span></p>
<ul>
<li>$ h_i(t) $: hazard for individual <span class="math inline">\(i\)</span> at time <span class="math inline">\(t\)</span>,</li>
<li>$ h_0(t) $: <strong>baseline hazard function</strong> — the hazard when all covariates and association terms are zero,</li>
<li>$ _i $: baseline covariates (e.g., treatment),</li>
<li>The <strong>association terms</strong> link the longitudinal process to the event risk (e.g., current value of a biomarker).</li>
</ul>
<section id="how-is-this-different-from-a-standard-shared-random-effects-joint-model" class="level3">
<h3 class="anchored" data-anchor-id="how-is-this-different-from-a-standard-shared-random-effects-joint-model">How is this different from a “standard” shared random effects joint model?</h3>
<ul>
<li><p>In <strong>classical joint models</strong>, $ h_0(t) $ is often left <strong>unspecified</strong> (semi-parametric, like in Cox regression) or approximated via splines.</p></li>
<li><p>In <strong><code>JMbayes2</code></strong>, the baseline hazard is <strong>explicitly modeled</strong> using flexible parametric forms (e.g., B-splines, piecewise constants, Weibull).</p></li>
<li><p>This allows:</p>
<ul>
<li>Full Bayesian inference,</li>
<li>Smooth estimation of $ h_0(t) $,</li>
<li>Extrapolation beyond observed event times (with appropriate bases),</li>
<li>Stratified or heterogeneous baseline hazards.</li>
</ul></li>
</ul>
<p>Crucially, <strong><code>JMbayes2</code> does not use a Cox partial likelihood</strong>. Instead, it <strong>fully parametrizes</strong> $ h_0(t) $, which is essential for:</p>
<ul>
<li>Dynamic predictions,</li>
<li>Proper posterior inference,</li>
<li>Integration with Stan-based MCMC sampling.</li>
</ul>
</section>
<section id="implementing-different-baseline-hazard-specifications-in-r" class="level2">
<h2 class="anchored" data-anchor-id="implementing-different-baseline-hazard-specifications-in-r">Implementing Different Baseline Hazard Specifications in R</h2>
<p>Baseline Hazard can be implemented using the {JMbayes2} package in R for <strong>Bayesian joint modeling of longitudinal and time-to-event (survival) data</strong>. It enables simultaneous analysis of repeated longitudinal measurements (e.g., biomarker trajectories) and event outcomes (e.g., death or disease progression) by linking them through shared random effects or other association structures. Built on <strong>Stan</strong> for efficient Hamiltonian Monte Carlo sampling, {JMbayes2} supports flexible model specifications, including linear, generalized linear, or nonlinear mixed-effects models for the longitudinal submodel and Cox or accelerated failure time models for the survival submodel.</p>
<p><img src="Image/jbbyaes2_logo.png" class="img-fluid" width="120"></p>
<p>We’ll use the <strong>AIDS dataset</strong> included in <code>JMbayes2</code>, which contains:</p>
<ul>
<li>Longitudinal CD4 cell counts (square-root transformed),</li>
<li>Time-to-death with censoring,</li>
<li>Treatment group (<code>drug</code>: ddC or ddI).</li>
</ul>
<section id="install-required-r-packages" class="level3">
<h3 class="anchored" data-anchor-id="install-required-r-packages">Install Required R Packages</h3>
<p>Following R packages are required to run this notebook. If any of these packages are not installed, you can install them using the code below:</p>
<div class="cell">
<details open="" class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb1"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb1-1"><a href="#cb1-1" aria-hidden="true" tabindex="-1"></a>packages <span class="ot">&lt;-</span><span class="fu">c</span>(</span>
<span id="cb1-2"><a href="#cb1-2" aria-hidden="true" tabindex="-1"></a>         <span class="st">'tidyverse'</span>,</span>
<span id="cb1-3"><a href="#cb1-3" aria-hidden="true" tabindex="-1"></a>         <span class="st">'survival'</span>,</span>
<span id="cb1-4"><a href="#cb1-4" aria-hidden="true" tabindex="-1"></a>         <span class="st">'survminer'</span>,</span>
<span id="cb1-5"><a href="#cb1-5" aria-hidden="true" tabindex="-1"></a>         <span class="st">'ggsurvfit'</span>,</span>
<span id="cb1-6"><a href="#cb1-6" aria-hidden="true" tabindex="-1"></a>         <span class="st">'tidycmprsk'</span>,</span>
<span id="cb1-7"><a href="#cb1-7" aria-hidden="true" tabindex="-1"></a>         <span class="st">'ggfortify'</span>,</span>
<span id="cb1-8"><a href="#cb1-8" aria-hidden="true" tabindex="-1"></a>         <span class="st">'timereg'</span>,</span>
<span id="cb1-9"><a href="#cb1-9" aria-hidden="true" tabindex="-1"></a>         <span class="st">'cmprsk'</span>,</span>
<span id="cb1-10"><a href="#cb1-10" aria-hidden="true" tabindex="-1"></a>         <span class="st">'condSURV'</span>,</span>
<span id="cb1-11"><a href="#cb1-11" aria-hidden="true" tabindex="-1"></a>         <span class="st">'riskRegression'</span>,</span>
<span id="cb1-12"><a href="#cb1-12" aria-hidden="true" tabindex="-1"></a>         <span class="st">'prodlim'</span>,</span>
<span id="cb1-13"><a href="#cb1-13" aria-hidden="true" tabindex="-1"></a>         <span class="st">'lava'</span>,</span>
<span id="cb1-14"><a href="#cb1-14" aria-hidden="true" tabindex="-1"></a>         <span class="st">'mstate'</span>,</span>
<span id="cb1-15"><a href="#cb1-15" aria-hidden="true" tabindex="-1"></a>         <span class="st">'regplot'</span>,</span>
<span id="cb1-16"><a href="#cb1-16" aria-hidden="true" tabindex="-1"></a>         <span class="st">'cmprskcoxmsm'</span>,</span>
<span id="cb1-17"><a href="#cb1-17" aria-hidden="true" tabindex="-1"></a>         <span class="st">'GLMMadaptive'</span>,</span>
<span id="cb1-18"><a href="#cb1-18" aria-hidden="true" tabindex="-1"></a>         <span class="st">'nlme'</span>,</span>
<span id="cb1-19"><a href="#cb1-19" aria-hidden="true" tabindex="-1"></a>         <span class="st">'lme4'</span>,</span>
<span id="cb1-20"><a href="#cb1-20" aria-hidden="true" tabindex="-1"></a>         <span class="st">'lattice'</span>,</span>
<span id="cb1-21"><a href="#cb1-21" aria-hidden="true" tabindex="-1"></a>         <span class="st">'JM'</span>,</span>
<span id="cb1-22"><a href="#cb1-22" aria-hidden="true" tabindex="-1"></a>         <span class="st">'joineR'</span>,</span>
<span id="cb1-23"><a href="#cb1-23" aria-hidden="true" tabindex="-1"></a>         <span class="st">'joineRML'</span>,</span>
<span id="cb1-24"><a href="#cb1-24" aria-hidden="true" tabindex="-1"></a>         <span class="st">'JMbayes2'</span></span>
<span id="cb1-25"><a href="#cb1-25" aria-hidden="true" tabindex="-1"></a>         </span>
<span id="cb1-26"><a href="#cb1-26" aria-hidden="true" tabindex="-1"></a>         )</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<p>```{r<br>
#| warning: false #| error: false</p>
</section>
</section>
</section>
<section id="install-missing-packages" class="level1">
<h1>Install missing packages</h1>
<p>new_packages &lt;- packages[!(packages %in% installed.packages()[,“Package”])] if(length(new_packages)) install.packages(new_packages)</p>
<p>#devtools::install_github(“ItziarI/WeDiBaDis”)</p>
<pre><code>
### Verify Installation


::: {.cell}

```{.r .cell-code}
# Verify installation
cat("Installed packages:\n")</code></pre>
<div class="cell-output cell-output-stdout">
<pre><code>Installed packages:</code></pre>
</div>
<details open="" class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb4"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb4-1"><a href="#cb4-1" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(<span class="fu">sapply</span>(packages, requireNamespace, <span class="at">quietly =</span> <span class="cn">TRUE</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stderr">
<pre><code>Registered S3 method overwritten by 'riskRegression':
  method        from 
  nobs.multinom broom</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Registered S3 methods overwritten by 'joineRML':
  method         from 
  augment.mjoint broom
  glance.mjoint  broom
  tidy.mjoint    broom</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>     tidyverse       survival      survminer      ggsurvfit     tidycmprsk 
          TRUE           TRUE           TRUE           TRUE           TRUE 
     ggfortify        timereg         cmprsk       condSURV riskRegression 
          TRUE           TRUE           TRUE           TRUE           TRUE 
       prodlim           lava         mstate        regplot   cmprskcoxmsm 
          TRUE           TRUE           TRUE           TRUE           TRUE 
  GLMMadaptive           nlme           lme4        lattice             JM 
          TRUE           TRUE           TRUE           TRUE           TRUE 
        joineR       joineRML       JMbayes2 
          TRUE           TRUE           TRUE </code></pre>
</div>
<p>:::</p>
<section id="load-packages" class="level3">
<h3 class="anchored" data-anchor-id="load-packages">Load Packages</h3>
<div class="cell">
<details open="" class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb8"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb8-1"><a href="#cb8-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Load packages with suppressed messages</span></span>
<span id="cb8-2"><a href="#cb8-2" aria-hidden="true" tabindex="-1"></a><span class="fu">invisible</span>(<span class="fu">lapply</span>(packages, <span class="cf">function</span>(pkg) {</span>
<span id="cb8-3"><a href="#cb8-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">suppressPackageStartupMessages</span>(<span class="fu">library</span>(pkg, <span class="at">character.only =</span> <span class="cn">TRUE</span>))</span>
<span id="cb8-4"><a href="#cb8-4" aria-hidden="true" tabindex="-1"></a>}))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<div class="cell">
<details open="" class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb9"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb9-1"><a href="#cb9-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Check loaded packages</span></span>
<span id="cb9-2"><a href="#cb9-2" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">"Successfully loaded packages:</span><span class="sc">\n</span><span class="st">"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>Successfully loaded packages:</code></pre>
</div>
<details open="" class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb11"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb11-1"><a href="#cb11-1" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(<span class="fu">search</span>()[<span class="fu">grepl</span>(<span class="st">"package:"</span>, <span class="fu">search</span>())])</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code> [1] "package:JMbayes2"       "package:joineRML"       "package:joineR"        
 [4] "package:JM"             "package:splines"        "package:MASS"          
 [7] "package:lattice"        "package:lme4"           "package:Matrix"        
[10] "package:nlme"           "package:GLMMadaptive"   "package:cmprskcoxmsm"  
[13] "package:regplot"        "package:mstate"         "package:lava"          
[16] "package:prodlim"        "package:riskRegression" "package:condSURV"      
[19] "package:cmprsk"         "package:timereg"        "package:ggfortify"     
[22] "package:tidycmprsk"     "package:ggsurvfit"      "package:survminer"     
[25] "package:ggpubr"         "package:survival"       "package:lubridate"     
[28] "package:forcats"        "package:stringr"        "package:dplyr"         
[31] "package:purrr"          "package:readr"          "package:tidyr"         
[34] "package:tibble"         "package:ggplot2"        "package:tidyverse"     
[37] "package:stats"          "package:graphics"       "package:grDevices"     
[40] "package:utils"          "package:datasets"       "package:methods"       
[43] "package:base"          </code></pre>
</div>
</div>
</section>
<section id="load-data" class="level3">
<h3 class="anchored" data-anchor-id="load-data">Load data</h3>
<div class="cell">
<details open="" class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb13"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb13-1"><a href="#cb13-1" aria-hidden="true" tabindex="-1"></a><span class="fu">data</span>(aids)</span>
<span id="cb13-2"><a href="#cb13-2" aria-hidden="true" tabindex="-1"></a><span class="fu">data</span>(aids.id)  <span class="co"># baseline/event data (one row per patient)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
</section>
<section id="fit-a-longitudinal-submodel" class="level3">
<h3 class="anchored" data-anchor-id="fit-a-longitudinal-submodel">Fit a longitudinal submodel</h3>
<p>We model square-root CD4 counts with a natural spline for time and treatment interaction:</p>
<div class="cell">
<details open="" class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb14"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb14-1"><a href="#cb14-1" aria-hidden="true" tabindex="-1"></a>fm <span class="ot">&lt;-</span> <span class="fu">lme</span>(<span class="fu">sqrt</span>(CD4) <span class="sc">~</span> <span class="fu">ns</span>(obstime, <span class="dv">2</span>) <span class="sc">*</span> drug,</span>
<span id="cb14-2"><a href="#cb14-2" aria-hidden="true" tabindex="-1"></a>          <span class="at">data =</span> aids,</span>
<span id="cb14-3"><a href="#cb14-3" aria-hidden="true" tabindex="-1"></a>          <span class="at">random =</span> <span class="fu">list</span>(<span class="at">patient =</span> <span class="fu">pdDiag</span>(<span class="sc">~</span> <span class="fu">ns</span>(obstime, <span class="dv">2</span>))))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
</section>
<section id="fit-a-cox-model-for-the-event-process" class="level3">
<h3 class="anchored" data-anchor-id="fit-a-cox-model-for-the-event-process">Fit a Cox model for the event process</h3>
<div class="cell">
<details open="" class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb15"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb15-1"><a href="#cb15-1" aria-hidden="true" tabindex="-1"></a>CoxFit <span class="ot">&lt;-</span> <span class="fu">coxph</span>(<span class="fu">Surv</span>(Time, death) <span class="sc">~</span> drug, <span class="at">data =</span> aids.id)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<blockquote class="blockquote">
<p>Note: <code>coxph()</code> is only used to <strong>extract design information</strong> (covariates, event times). <code>JMbayes2</code> will <strong>replace</strong> the baseline hazard with its own parametric form.</p>
</blockquote>
</section>
<section id="different-baseline-hazard-specifications" class="level3">
<h3 class="anchored" data-anchor-id="different-baseline-hazard-specifications">Different Baseline Hazard Specifications</h3>
<p>All models below use the same longitudinal and covariate structure but differ in how $ h_0(t) $ is modeled.</p>
<section id="penalized-b-splines-quadratic-on-original-time-scale---default" class="level4">
<h4 class="anchored" data-anchor-id="penalized-b-splines-quadratic-on-original-time-scale---default">Penalized B-splines (Quadratic, on Original Time Scale) - Default</h4>
<div class="cell">
<details open="" class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb16"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb16-1"><a href="#cb16-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Fit joint model with default B-splines baseline hazard</span></span>
<span id="cb16-2"><a href="#cb16-2" aria-hidden="true" tabindex="-1"></a>jointFit1 <span class="ot">&lt;-</span> <span class="fu">jm</span>(CoxFit, fm, <span class="at">time_var =</span> <span class="st">"obstime"</span>)</span>
<span id="cb16-3"><a href="#cb16-3" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(jointFit1)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>
Call:
jm(Surv_object = CoxFit, Mixed_objects = fm, time_var = "obstime")

Data Descriptives:
Number of Groups: 467       Number of events: 188 (40.3%)
Number of Observations:
  sqrt(CD4): 1405

                 DIC     WAIC      LPML
marginal    4138.804 4212.706 -2106.414
conditional 6141.640 5830.969 -3389.947

Random-effects covariance matrix:
                           
       StdDev   Corr       
(Intr) 0.8700 (Intr) n(,2)1
n(,2)1 0.6549              
n(,2)2 0.2462              

Survival Outcome:
                    Mean  StDev    2.5%   97.5%      P   Rhat
drugddI           0.3586 0.1949 -0.0271  0.7222 0.0642 1.0119
value(sqrt(CD4)) -1.0771 0.1209 -1.3341 -0.8501 0.0000 1.0128

Longitudinal Outcome: sqrt(CD4) (family = gaussian, link = identity)
                   Mean  StDev    2.5%   97.5%      P   Rhat
(Intercept)      2.4997 0.0606  2.3807  2.6173 0.0000 1.0012
ns(obstime, 2)1 -0.7564 0.0854 -0.9225 -0.5845 0.0000 1.0104
ns(obstime, 2)2 -0.4182 0.1080 -0.6190 -0.2237 0.0000 1.0458
drugddI          0.0471 0.0854 -0.1211  0.2145 0.5851 1.0004
n(,2)1           0.1912 0.1206 -0.0414  0.4290 0.1107 1.0073
n(,2)2          -0.1243 0.1306 -0.3724  0.1341 0.3676 1.0543
sigma            0.3755 0.0104  0.3561  0.3964 0.0000 1.0036

MCMC summary:
chains: 3 
iterations per chain: 3500 
burn-in per chain: 500 
thinning: 1 
time: 21 sec</code></pre>
</div>
</div>
<div class="cell">
<details open="" class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb18"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb18-1"><a href="#cb18-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Plot estimated baseline hazard</span></span>
<span id="cb18-2"><a href="#cb18-2" aria-hidden="true" tabindex="-1"></a>JMbayes2<span class="sc">:::</span><span class="fu">plot_hazard</span>(jointFit1) </span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="02-07-06-02-survival-analysis-baseline-hazard-function-r_files/figure-html/unnamed-chunk-9-1.png" class="img-fluid figure-img" width="576"></p>
</figure>
</div>
</div>
</div>
<ul>
<li><strong>Basis</strong>: Quadratic B-splines (<code>Bsplines_degree = 2</code>),</li>
<li><strong>Knots</strong>: 9 equidistant knots in $ (10^{-8}, T_{}) $,</li>
<li><strong>Penalty</strong>: Second-order difference penalty on spline coefficients,</li>
<li><strong>Prior on smoothing</strong>: $ (5, 0.5) $.</li>
</ul>
<blockquote class="blockquote">
<p>Smooth, flexible, default choice.</p>
</blockquote>
</section>
<section id="natural-cubic-splines-on-logtime" class="level4">
<h4 class="anchored" data-anchor-id="natural-cubic-splines-on-logtime">Natural Cubic Splines on Log(Time)</h4>
<p>Avoids issues with $ H_0(0) &gt; 0 $ and improves behavior near time zero.</p>
<div class="cell">
<details open="" class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb19"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb19-1"><a href="#cb19-1" aria-hidden="true" tabindex="-1"></a><span class="co"># update joint model with natural cubic splines on log(time)</span></span>
<span id="cb19-2"><a href="#cb19-2" aria-hidden="true" tabindex="-1"></a>jointFit2 <span class="ot">&lt;-</span> <span class="fu">update</span>(jointFit1, <span class="at">base_hazard =</span> <span class="st">"log time, ns"</span>)</span>
<span id="cb19-3"><a href="#cb19-3" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(jointFit2)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>
Call:
jm(Surv_object = CoxFit, Mixed_objects = fm, time_var = "obstime", 
    base_hazard = "log time, ns")

Data Descriptives:
Number of Groups: 467       Number of events: 188 (40.3%)
Number of Observations:
  sqrt(CD4): 1405

                 DIC     WAIC      LPML
marginal    4138.804 4212.706 -2106.414
conditional 6141.640 5830.969 -3389.947

Random-effects covariance matrix:
                           
       StdDev   Corr       
(Intr) 0.8700 (Intr) n(,2)1
n(,2)1 0.6549              
n(,2)2 0.2462              

Survival Outcome:
                    Mean  StDev    2.5%   97.5%      P   Rhat
drugddI           0.3586 0.1949 -0.0271  0.7222 0.0642 1.0119
value(sqrt(CD4)) -1.0771 0.1209 -1.3341 -0.8501 0.0000 1.0128

Longitudinal Outcome: sqrt(CD4) (family = gaussian, link = identity)
                   Mean  StDev    2.5%   97.5%      P   Rhat
(Intercept)      2.4997 0.0606  2.3807  2.6173 0.0000 1.0012
ns(obstime, 2)1 -0.7564 0.0854 -0.9225 -0.5845 0.0000 1.0104
ns(obstime, 2)2 -0.4182 0.1080 -0.6190 -0.2237 0.0000 1.0458
drugddI          0.0471 0.0854 -0.1211  0.2145 0.5851 1.0004
n(,2)1           0.1912 0.1206 -0.0414  0.4290 0.1107 1.0073
n(,2)2          -0.1243 0.1306 -0.3724  0.1341 0.3676 1.0543
sigma            0.3755 0.0104  0.3561  0.3964 0.0000 1.0036

MCMC summary:
chains: 3 
iterations per chain: 3500 
burn-in per chain: 500 
thinning: 1 
time: 20 sec</code></pre>
</div>
</div>
<div class="cell">
<details open="" class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb21"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb21-1"><a href="#cb21-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Plot estimated baseline hazard with natural cubic splines on log(time)</span></span>
<span id="cb21-2"><a href="#cb21-2" aria-hidden="true" tabindex="-1"></a>JMbayes2<span class="sc">:::</span><span class="fu">plot_hazard</span>(jointFit2)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="02-07-06-02-survival-analysis-baseline-hazard-function-r_files/figure-html/unnamed-chunk-11-1.png" class="img-fluid figure-img" width="576"></p>
</figure>
</div>
</div>
</div>
<ul>
<li>Equivalent to:</li>
</ul>
<div class="cell">
<details open="" class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb22"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb22-1"><a href="#cb22-1" aria-hidden="true" tabindex="-1"></a><span class="fu">update</span>(jointFit1, </span>
<span id="cb22-2"><a href="#cb22-2" aria-hidden="true" tabindex="-1"></a>         <span class="at">timescale_base_hazard =</span> <span class="st">"log"</span>, </span>
<span id="cb22-3"><a href="#cb22-3" aria-hidden="true" tabindex="-1"></a>         <span class="at">basis =</span> <span class="st">"ns"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>
Call:
jm(Surv_object = CoxFit, Mixed_objects = fm, time_var = "obstime", 
    timescale_base_hazard = "log", basis = "ns")

Random-effects covariance matrix:
                           
       StdDev   Corr       
(Intr) 0.8700 (Intr) n(,2)1
n(,2)1 0.6549              
n(,2)2 0.2462              

Survival Outcome:
                    Mean  StDev    2.5%   97.5%      P   Rhat
drugddI           0.3586 0.1949 -0.0271  0.7222 0.0642 1.0119
value(sqrt(CD4)) -1.0771 0.1209 -1.3341 -0.8501 0.0000 1.0128

Longitudinal Outcome: sqrt(CD4) (family = gaussian, link = identity)
                   Mean  StDev    2.5%   97.5%      P   Rhat
(Intercept)      2.4997 0.0606  2.3807  2.6173 0.0000 1.0012
ns(obstime, 2)1 -0.7564 0.0854 -0.9225 -0.5845 0.0000 1.0104
ns(obstime, 2)2 -0.4182 0.1080 -0.6190 -0.2237 0.0000 1.0458
drugddI          0.0471 0.0854 -0.1211  0.2145 0.5851 1.0004
n(,2)1           0.1912 0.1206 -0.0414  0.4290 0.1107 1.0073
n(,2)2          -0.1243 0.1306 -0.3724  0.1341 0.3676 1.0543
sigma            0.3755 0.0104  0.3561  0.3964 0.0000 1.0036</code></pre>
</div>
</div>
<ul>
<li><strong>Natural cubic splines</strong> enforce linearity beyond boundary knots,</li>
<li>Works on <strong>log(time)</strong>, which often better captures hazard dynamics in chronic diseases.</li>
</ul>
<blockquote class="blockquote">
<p>Recommended for extrapolation and improved boundary behavior.</p>
</blockquote>
</section>
<section id="piecewise-constant-hazard" class="level4">
<h4 class="anchored" data-anchor-id="piecewise-constant-hazard">Piecewise Constant Hazard</h4>
<p>Assumes hazard is constant within intervals (like in Poisson models).</p>
<div class="cell">
<details open="" class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb24"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb24-1"><a href="#cb24-1" aria-hidden="true" tabindex="-1"></a>jointFit3 <span class="ot">&lt;-</span> <span class="fu">update</span>(jointFit1, </span>
<span id="cb24-2"><a href="#cb24-2" aria-hidden="true" tabindex="-1"></a>                    <span class="at">base_hazard =</span> <span class="st">"piecewise constant"</span>,</span>
<span id="cb24-3"><a href="#cb24-3" aria-hidden="true" tabindex="-1"></a>                    <span class="at">base_hazard_segments =</span> <span class="dv">5</span>L)</span>
<span id="cb24-4"><a href="#cb24-4" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(jointFit3)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>
Call:
jm(Surv_object = CoxFit, Mixed_objects = fm, time_var = "obstime", 
    base_hazard = "piecewise constant", base_hazard_segments = 5L)

Data Descriptives:
Number of Groups: 467       Number of events: 188 (40.3%)
Number of Observations:
  sqrt(CD4): 1405

                 DIC     WAIC      LPML
marginal    4194.968 4233.162 -2116.733
conditional 6274.490 5926.884 -3425.913

Random-effects covariance matrix:
                           
       StdDev   Corr       
(Intr) 0.8702 (Intr) n(,2)1
n(,2)1 0.6486              
n(,2)2 0.2714              

Survival Outcome:
                    Mean  StDev    2.5%   97.5%      P   Rhat
drugddI           0.3518 0.1728  0.0252  0.6865 0.0324 1.0006
value(sqrt(CD4)) -1.0737 0.1168 -1.3105 -0.8462 0.0000 1.0125

Longitudinal Outcome: sqrt(CD4) (family = gaussian, link = identity)
                   Mean  StDev    2.5%   97.5%      P   Rhat
(Intercept)      2.4992 0.0611  2.3804  2.6168 0.0000 1.0063
ns(obstime, 2)1 -0.7538 0.0852 -0.9241 -0.5881 0.0000 1.0385
ns(obstime, 2)2 -0.3943 0.0823 -0.5505 -0.2299 0.0000 1.0392
drugddI          0.0470 0.0870 -0.1218  0.2160 0.5867 1.0017
n(,2)1           0.1878 0.1253 -0.0542  0.4316 0.1333 1.0150
n(,2)2          -0.1505 0.1277 -0.3957  0.1072 0.2613 1.0821
sigma            0.3751 0.0109  0.3541  0.3972 0.0000 1.0088

MCMC summary:
chains: 3 
iterations per chain: 3500 
burn-in per chain: 500 
thinning: 1 
time: 17 sec</code></pre>
</div>
</div>
<div class="cell">
<details open="" class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb26"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb26-1"><a href="#cb26-1" aria-hidden="true" tabindex="-1"></a>JMbayes2<span class="sc">:::</span><span class="fu">plot_hazard</span>(jointFit3)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="02-07-06-02-survival-analysis-baseline-hazard-function-r_files/figure-html/unnamed-chunk-14-1.png" class="img-fluid figure-img" width="576"></p>
</figure>
</div>
</div>
</div>
<ul>
<li>Splits follow-up into 5 equal-length intervals,</li>
<li>Estimates one hazard level per interval,</li>
<li><strong>Not smooth</strong>, but simple and interpretable.</li>
</ul>
<blockquote class="blockquote">
<p>Use for robustness checks or when smoothness is not critical.</p>
</blockquote>
</section>
<section id="piecewise-linear-hazard-on-log-time" class="level4">
<h4 class="anchored" data-anchor-id="piecewise-linear-hazard-on-log-time">Piecewise Linear Hazard (on Log Time)</h4>
<p>Connects hazard estimates with straight lines.</p>
<div class="cell">
<details open="" class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb27"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb27-1"><a href="#cb27-1" aria-hidden="true" tabindex="-1"></a>jointFit4 <span class="ot">&lt;-</span> <span class="fu">update</span>(jointFit1,</span>
<span id="cb27-2"><a href="#cb27-2" aria-hidden="true" tabindex="-1"></a>                    <span class="at">base_hazard =</span> <span class="st">"piecewise linear, log time"</span>,</span>
<span id="cb27-3"><a href="#cb27-3" aria-hidden="true" tabindex="-1"></a>                    <span class="at">base_hazard_segments =</span> <span class="dv">3</span>L,</span>
<span id="cb27-4"><a href="#cb27-4" aria-hidden="true" tabindex="-1"></a>                    <span class="at">priors =</span> <span class="fu">list</span>(<span class="at">penalized_bs_gammas =</span> <span class="cn">FALSE</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<div class="cell">
<details open="" class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb28"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb28-1"><a href="#cb28-1" aria-hidden="true" tabindex="-1"></a>JMbayes2<span class="sc">:::</span><span class="fu">plot_hazard</span>(jointFit4)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="02-07-06-02-survival-analysis-baseline-hazard-function-r_files/figure-html/unnamed-chunk-16-1.png" class="img-fluid figure-img" width="576"></p>
</figure>
</div>
</div>
</div>
<ul>
<li>Uses 3 segments → 4 knots → 3 linear pieces,</li>
<li><strong>No penalization</strong> (flat normal prior on coefficients),</li>
<li>Less smooth than splines but more flexible than piecewise constant.</li>
</ul>
</section>
<section id="weibull-baseline-hazard" class="level4">
<h4 class="anchored" data-anchor-id="weibull-baseline-hazard">Weibull Baseline Hazard</h4>
<p>Parametric, assumes $ h_0(t) = t^{- 1} $.</p>
<div class="cell">
<details open="" class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb29"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb29-1"><a href="#cb29-1" aria-hidden="true" tabindex="-1"></a>jointFit5 <span class="ot">&lt;-</span> <span class="fu">update</span>(jointFit1, <span class="at">base_hazard =</span> <span class="st">"weibull"</span>)</span>
<span id="cb29-2"><a href="#cb29-2" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(jointFit5)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>
Call:
jm(Surv_object = CoxFit, Mixed_objects = fm, time_var = "obstime", 
    base_hazard = "weibull")

Data Descriptives:
Number of Groups: 467       Number of events: 188 (40.3%)
Number of Observations:
  sqrt(CD4): 1405

                 DIC     WAIC      LPML
marginal    4138.804 4212.706 -2106.414
conditional 6141.640 5830.969 -3389.947

Random-effects covariance matrix:
                           
       StdDev   Corr       
(Intr) 0.8700 (Intr) n(,2)1
n(,2)1 0.6549              
n(,2)2 0.2462              

Survival Outcome:
                    Mean  StDev    2.5%   97.5%      P   Rhat
drugddI           0.3586 0.1949 -0.0271  0.7222 0.0642 1.0119
value(sqrt(CD4)) -1.0771 0.1209 -1.3341 -0.8501 0.0000 1.0128

Longitudinal Outcome: sqrt(CD4) (family = gaussian, link = identity)
                   Mean  StDev    2.5%   97.5%      P   Rhat
(Intercept)      2.4997 0.0606  2.3807  2.6173 0.0000 1.0012
ns(obstime, 2)1 -0.7564 0.0854 -0.9225 -0.5845 0.0000 1.0104
ns(obstime, 2)2 -0.4182 0.1080 -0.6190 -0.2237 0.0000 1.0458
drugddI          0.0471 0.0854 -0.1211  0.2145 0.5851 1.0004
n(,2)1           0.1912 0.1206 -0.0414  0.4290 0.1107 1.0073
n(,2)2          -0.1243 0.1306 -0.3724  0.1341 0.3676 1.0543
sigma            0.3755 0.0104  0.3561  0.3964 0.0000 1.0036

MCMC summary:
chains: 3 
iterations per chain: 3500 
burn-in per chain: 500 
thinning: 1 
time: 21 sec</code></pre>
</div>
</div>
<div class="cell">
<details open="" class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb31"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb31-1"><a href="#cb31-1" aria-hidden="true" tabindex="-1"></a>JMbayes2<span class="sc">:::</span><span class="fu">plot_hazard</span>(jointFit5)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="02-07-06-02-survival-analysis-baseline-hazard-function-r_files/figure-html/unnamed-chunk-18-1.png" class="img-fluid figure-img" width="576"></p>
</figure>
</div>
</div>
</div>
<div class="cell">
<details open="" class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb32"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb32-1"><a href="#cb32-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Extrapolate to month 24</span></span>
<span id="cb32-2"><a href="#cb32-2" aria-hidden="true" tabindex="-1"></a>JMbayes2<span class="sc">:::</span><span class="fu">plot_hazard</span>(jointFit5, <span class="at">tmax =</span> <span class="dv">24</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="02-07-06-02-survival-analysis-baseline-hazard-function-r_files/figure-html/unnamed-chunk-19-1.png" class="img-fluid figure-img" width="576"></p>
</figure>
</div>
</div>
</div>
<ul>
<li>Equivalent to modeling $ h_0(t) = _0 + _1 t $,</li>
<li><strong>Fully parametric</strong> → enables reliable extrapolation,</li>
<li>Only 2 parameters → less flexible but more stable with small samples.</li>
</ul>
<blockquote class="blockquote">
<p>Ideal when proportional hazards and Weibull shape are plausible.</p>
</blockquote>
</section>
<section id="stratified-baseline-hazards" class="level4">
<h4 class="anchored" data-anchor-id="stratified-baseline-hazards">Stratified Baseline Hazards</h4>
<p>Allow different $ h_0(t) $ per group (e.g., by treatment).</p>
<div class="cell">
<details open="" class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb33"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb33-1"><a href="#cb33-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Refit Cox model with stratification</span></span>
<span id="cb33-2"><a href="#cb33-2" aria-hidden="true" tabindex="-1"></a>CoxFit2 <span class="ot">&lt;-</span> <span class="fu">coxph</span>(<span class="fu">Surv</span>(Time, death) <span class="sc">~</span> <span class="fu">strata</span>(drug), <span class="at">data =</span> aids.id)</span>
<span id="cb33-3"><a href="#cb33-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb33-4"><a href="#cb33-4" aria-hidden="true" tabindex="-1"></a><span class="co"># Fit joint model with different baseline hazards per stratum</span></span>
<span id="cb33-5"><a href="#cb33-5" aria-hidden="true" tabindex="-1"></a>jointFit6 <span class="ot">&lt;-</span> <span class="fu">jm</span>(CoxFit2, fm, <span class="at">time_var =</span> <span class="st">"obstime"</span>,</span>
<span id="cb33-6"><a href="#cb33-6" aria-hidden="true" tabindex="-1"></a>                <span class="at">base_hazard =</span> <span class="fu">c</span>(<span class="st">"weibull"</span>, <span class="st">"log time, ns"</span>))</span>
<span id="cb33-7"><a href="#cb33-7" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(jointFit6)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>
Call:
jm(Surv_object = CoxFit2, Mixed_objects = fm, time_var = "obstime", 
    base_hazard = c("weibull", "log time, ns"))

Data Descriptives:
Number of Groups: 467       Number of events: 188 (40.3%)
Number of Observations:
  sqrt(CD4): 1405

                 DIC    WAIC      LPML
marginal    4097.208 4209.99 -2105.142
conditional 5870.487 5594.83 -3229.422

Random-effects covariance matrix:
                           
       StdDev   Corr       
(Intr) 0.8655 (Intr) n(,2)1
n(,2)1 0.6561              
n(,2)2 0.1900              

Survival Outcome:
                    Mean  StDev   2.5%   97.5% P   Rhat
1                 0.0000 0.0000  0.000  0.0000 0    NaN
value(sqrt(CD4)) -1.0755 0.1574 -1.385 -0.7743 0 1.0417

Longitudinal Outcome: sqrt(CD4) (family = gaussian, link = identity)
                   Mean  StDev    2.5%   97.5%      P   Rhat
(Intercept)      2.4996 0.0611  2.3773  2.6181 0.0000 1.0004
ns(obstime, 2)1 -0.7525 0.0854 -0.9266 -0.5940 0.0000 1.0073
ns(obstime, 2)2 -0.3836 0.0932 -0.5769 -0.2002 0.0000 1.1067
drugddI          0.0434 0.0871 -0.1230  0.2170 0.6269 1.0048
n(,2)1           0.1956 0.1217 -0.0403  0.4324 0.1053 1.0180
n(,2)2          -0.1829 0.1295 -0.4483  0.1007 0.1522 1.1595
sigma            0.3770 0.0112  0.3554  0.3990 0.0000 1.0621

MCMC summary:
chains: 3 
iterations per chain: 3500 
burn-in per chain: 500 
thinning: 1 
time: 31 sec</code></pre>
</div>
</div>
<div class="cell">
<details open="" class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb35"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb35-1"><a href="#cb35-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Plot both strata</span></span>
<span id="cb35-2"><a href="#cb35-2" aria-hidden="true" tabindex="-1"></a><span class="co"># JMbayes2:::plot_hazard(jointFit6)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<ul>
<li>First element (<code>"weibull"</code>) → for first level of <code>drug</code> (e.g., ddC),</li>
<li>Second (<code>"log time, ns"</code>) → for second level (e.g., ddI),</li>
<li>Use <code>NA</code> to apply the default to a stratum: <code>c("weibull", NA)</code>.</li>
</ul>
<blockquote class="blockquote">
<p>Useful when proportional hazards assumption is violated across groups.</p>
</blockquote>
</section>
<section id="summary-table-of-options" class="level4">
<h4 class="anchored" data-anchor-id="summary-table-of-options">Summary Table of Options</h4>
<table class="table">
<colgroup>
<col style="width: 30%">
<col style="width: 37%">
<col style="width: 8%">
<col style="width: 17%">
<col style="width: 6%">
</colgroup>
<thead>
<tr class="header">
<th>Specification</th>
<th><code>base_hazard</code> value</th>
<th>Smooth?</th>
<th>Extrapolation?</th>
<th>Notes</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>Default B-splines</td>
<td>(default)</td>
<td>Yes</td>
<td>Limited</td>
<td>Quadratic, penalized</td>
</tr>
<tr class="even">
<td>Natural cubic splines (log)</td>
<td><code>"log time, ns"</code></td>
<td>No</td>
<td>Yes</td>
<td>Recommended default</td>
</tr>
<tr class="odd">
<td>Piecewise constant</td>
<td><code>"piecewise constant"</code></td>
<td>No</td>
<td>No</td>
<td>Simple, robust</td>
</tr>
<tr class="even">
<td>Piecewise linear</td>
<td><code>"piecewise linear, log time"</code></td>
<td>-</td>
<td>-</td>
<td>Linear segments</td>
</tr>
<tr class="odd">
<td>Weibull</td>
<td><code>"weibull"</code></td>
<td>Yes</td>
<td>es</td>
<td>Fully parametric</td>
</tr>
<tr class="even">
<td>Stratified</td>
<td><code>c("weibull", "log time, ns")</code></td>
<td>Depends</td>
<td>Depends</td>
<td>Per-group flexibility</td>
</tr>
</tbody>
</table>
</section>
</section>
<section id="practical-tips" class="level3">
<h3 class="anchored" data-anchor-id="practical-tips">Practical Tips</h3>
<ul>
<li><strong>Start with <code>"log time, ns"</code></strong> — it often provides the best balance of flexibility and stability.</li>
<li>Use <strong>Weibull</strong> if you need to <strong>extrapolate</strong> (e.g., for long-term survival predictions).</li>
<li>Always <strong>inspect <code>plot_hazard()</code></strong> to assess smoothness and plausibility.</li>
<li>For <strong>stratified models</strong>, ensure your <code>coxph()</code> model uses <code>strata()</code>.</li>
</ul>
</section>
<section id="summary-and-conclusion" class="level2">
<h2 class="anchored" data-anchor-id="summary-and-conclusion">Summary and Conclusion</h2>
<p>In joint modeling of longitudinal and time-to-event data, the <strong>baseline hazard function</strong> $ h_0(t) $ plays a crucial role in defining the risk of an event over time. The {JMbayes2} package in R provides flexible options to specify and estimate $ h_0(t) $, allowing researchers to tailor the model to their data and research questions. By choosing appropriate baseline hazard specifications—ranging from penalized B-splines to parametric forms like Weibull—analysts can capture the underlying hazard dynamics effectively, leading to more accurate inferences and predictions. Careful consideration of the baseline hazard structure, along with thorough model diagnostics, is essential for robust joint modeling analyses.</p>
</section>
<section id="resources" class="level2">
<h2 class="anchored" data-anchor-id="resources">Resources</h2>
<ul>
<li>Rizopoulos, D. (2025). <em>Baseline Hazard Function</em>. <code>JMbayes2</code> Vignette.<br>
https://drizopoulos.github.io/JMbayes2/articles/Baseline_Hazard.html</li>
<li>Rizopoulos, D. (2012). <em>Joint Models for Longitudinal and Time-to-Event Data</em>. Chapman &amp; Hall/CRC.</li>
</ul>


</section>
</section>

</main> <!-- /main -->
<script id="quarto-html-after-body" type="application/javascript">
window.document.addEventListener("DOMContentLoaded", function (event) {
  const toggleBodyColorMode = (bsSheetEl) => {
    const mode = bsSheetEl.getAttribute("data-mode");
    const bodyEl = window.document.querySelector("body");
    if (mode === "dark") {
      bodyEl.classList.add("quarto-dark");
      bodyEl.classList.remove("quarto-light");
    } else {
      bodyEl.classList.add("quarto-light");
      bodyEl.classList.remove("quarto-dark");
    }
  }
  const toggleBodyColorPrimary = () => {
    const bsSheetEl = window.document.querySelector("link#quarto-bootstrap");
    if (bsSheetEl) {
      toggleBodyColorMode(bsSheetEl);
    }
  }
  toggleBodyColorPrimary();  
  const icon = "";
  const anchorJS = new window.AnchorJS();
  anchorJS.options = {
    placement: 'right',
    icon: icon
  };
  anchorJS.add('.anchored');
  const isCodeAnnotation = (el) => {
    for (const clz of el.classList) {
      if (clz.startsWith('code-annotation-')) {                     
        return true;
      }
    }
    return false;
  }
  const clipboard = new window.ClipboardJS('.code-copy-button', {
    text: function(trigger) {
      const codeEl = trigger.previousElementSibling.cloneNode(true);
      for (const childEl of codeEl.children) {
        if (isCodeAnnotation(childEl)) {
          childEl.remove();
        }
      }
      return codeEl.innerText;
    }
  });
  clipboard.on('success', function(e) {
    // button target
    const button = e.trigger;
    // don't keep focus
    button.blur();
    // flash "checked"
    button.classList.add('code-copy-button-checked');
    var currentTitle = button.getAttribute("title");
    button.setAttribute("title", "Copied!");
    let tooltip;
    if (window.bootstrap) {
      button.setAttribute("data-bs-toggle", "tooltip");
      button.setAttribute("data-bs-placement", "left");
      button.setAttribute("data-bs-title", "Copied!");
      tooltip = new bootstrap.Tooltip(button, 
        { trigger: "manual", 
          customClass: "code-copy-button-tooltip",
          offset: [0, -8]});
      tooltip.show();    
    }
    setTimeout(function() {
      if (tooltip) {
        tooltip.hide();
        button.removeAttribute("data-bs-title");
        button.removeAttribute("data-bs-toggle");
        button.removeAttribute("data-bs-placement");
      }
      button.setAttribute("title", currentTitle);
      button.classList.remove('code-copy-button-checked');
    }, 1000);
    // clear code selection
    e.clearSelection();
  });
    var localhostRegex = new RegExp(/^(?:http|https):\/\/localhost\:?[0-9]*\//);
    var mailtoRegex = new RegExp(/^mailto:/);
      var filterRegex = new RegExp('/' + window.location.host + '/');
    var isInternal = (href) => {
        return filterRegex.test(href) || localhostRegex.test(href) || mailtoRegex.test(href);
    }
    // Inspect non-navigation links and adorn them if external
 	var links = window.document.querySelectorAll('a[href]:not(.nav-link):not(.navbar-brand):not(.toc-action):not(.sidebar-link):not(.sidebar-item-toggle):not(.pagination-link):not(.no-external):not([aria-hidden]):not(.dropdown-item):not(.quarto-navigation-tool)');
    for (var i=0; i<links.length; i++) {
      const link = links[i];
      if (!isInternal(link.href)) {
        // undo the damage that might have been done by quarto-nav.js in the case of
        // links that we want to consider external
        if (link.dataset.originalHref !== undefined) {
          link.href = link.dataset.originalHref;
        }
      }
    }
  function tippyHover(el, contentFn, onTriggerFn, onUntriggerFn) {
    const config = {
      allowHTML: true,
      maxWidth: 500,
      delay: 100,
      arrow: false,
      appendTo: function(el) {
          return el.parentElement;
      },
      interactive: true,
      interactiveBorder: 10,
      theme: 'quarto',
      placement: 'bottom-start',
    };
    if (contentFn) {
      config.content = contentFn;
    }
    if (onTriggerFn) {
      config.onTrigger = onTriggerFn;
    }
    if (onUntriggerFn) {
      config.onUntrigger = onUntriggerFn;
    }
    window.tippy(el, config); 
  }
  const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
  for (var i=0; i<noterefs.length; i++) {
    const ref = noterefs[i];
    tippyHover(ref, function() {
      // use id or data attribute instead here
      let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
      try { href = new URL(href).hash; } catch {}
      const id = href.replace(/^#\/?/, "");
      const note = window.document.getElementById(id);
      if (note) {
        return note.innerHTML;
      } else {
        return "";
      }
    });
  }
  const xrefs = window.document.querySelectorAll('a.quarto-xref');
  const processXRef = (id, note) => {
    // Strip column container classes
    const stripColumnClz = (el) => {
      el.classList.remove("page-full", "page-columns");
      if (el.children) {
        for (const child of el.children) {
          stripColumnClz(child);
        }
      }
    }
    stripColumnClz(note)
    if (id === null || id.startsWith('sec-')) {
      // Special case sections, only their first couple elements
      const container = document.createElement("div");
      if (note.children && note.children.length > 2) {
        container.appendChild(note.children[0].cloneNode(true));
        for (let i = 1; i < note.children.length; i++) {
          const child = note.children[i];
          if (child.tagName === "P" && child.innerText === "") {
            continue;
          } else {
            container.appendChild(child.cloneNode(true));
            break;
          }
        }
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(container);
        }
        return container.innerHTML
      } else {
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(note);
        }
        return note.innerHTML;
      }
    } else {
      // Remove any anchor links if they are present
      const anchorLink = note.querySelector('a.anchorjs-link');
      if (anchorLink) {
        anchorLink.remove();
      }
      if (window.Quarto?.typesetMath) {
        window.Quarto.typesetMath(note);
      }
      // TODO in 1.5, we should make sure this works without a callout special case
      if (note.classList.contains("callout")) {
        return note.outerHTML;
      } else {
        return note.innerHTML;
      }
    }
  }
  for (var i=0; i<xrefs.length; i++) {
    const xref = xrefs[i];
    tippyHover(xref, undefined, function(instance) {
      instance.disable();
      let url = xref.getAttribute('href');
      let hash = undefined; 
      if (url.startsWith('#')) {
        hash = url;
      } else {
        try { hash = new URL(url).hash; } catch {}
      }
      if (hash) {
        const id = hash.replace(/^#\/?/, "");
        const note = window.document.getElementById(id);
        if (note !== null) {
          try {
            const html = processXRef(id, note.cloneNode(true));
            instance.setContent(html);
          } finally {
            instance.enable();
            instance.show();
          }
        } else {
          // See if we can fetch this
          fetch(url.split('#')[0])
          .then(res => res.text())
          .then(html => {
            const parser = new DOMParser();
            const htmlDoc = parser.parseFromString(html, "text/html");
            const note = htmlDoc.getElementById(id);
            if (note !== null) {
              const html = processXRef(id, note);
              instance.setContent(html);
            } 
          }).finally(() => {
            instance.enable();
            instance.show();
          });
        }
      } else {
        // See if we can fetch a full url (with no hash to target)
        // This is a special case and we should probably do some content thinning / targeting
        fetch(url)
        .then(res => res.text())
        .then(html => {
          const parser = new DOMParser();
          const htmlDoc = parser.parseFromString(html, "text/html");
          const note = htmlDoc.querySelector('main.content');
          if (note !== null) {
            // This should only happen for chapter cross references
            // (since there is no id in the URL)
            // remove the first header
            if (note.children.length > 0 && note.children[0].tagName === "HEADER") {
              note.children[0].remove();
            }
            const html = processXRef(null, note);
            instance.setContent(html);
          } 
        }).finally(() => {
          instance.enable();
          instance.show();
        });
      }
    }, function(instance) {
    });
  }
      let selectedAnnoteEl;
      const selectorForAnnotation = ( cell, annotation) => {
        let cellAttr = 'data-code-cell="' + cell + '"';
        let lineAttr = 'data-code-annotation="' +  annotation + '"';
        const selector = 'span[' + cellAttr + '][' + lineAttr + ']';
        return selector;
      }
      const selectCodeLines = (annoteEl) => {
        const doc = window.document;
        const targetCell = annoteEl.getAttribute("data-target-cell");
        const targetAnnotation = annoteEl.getAttribute("data-target-annotation");
        const annoteSpan = window.document.querySelector(selectorForAnnotation(targetCell, targetAnnotation));
        const lines = annoteSpan.getAttribute("data-code-lines").split(",");
        const lineIds = lines.map((line) => {
          return targetCell + "-" + line;
        })
        let top = null;
        let height = null;
        let parent = null;
        if (lineIds.length > 0) {
            //compute the position of the single el (top and bottom and make a div)
            const el = window.document.getElementById(lineIds[0]);
            top = el.offsetTop;
            height = el.offsetHeight;
            parent = el.parentElement.parentElement;
          if (lineIds.length > 1) {
            const lastEl = window.document.getElementById(lineIds[lineIds.length - 1]);
            const bottom = lastEl.offsetTop + lastEl.offsetHeight;
            height = bottom - top;
          }
          if (top !== null && height !== null && parent !== null) {
            // cook up a div (if necessary) and position it 
            let div = window.document.getElementById("code-annotation-line-highlight");
            if (div === null) {
              div = window.document.createElement("div");
              div.setAttribute("id", "code-annotation-line-highlight");
              div.style.position = 'absolute';
              parent.appendChild(div);
            }
            div.style.top = top - 2 + "px";
            div.style.height = height + 4 + "px";
            div.style.left = 0;
            let gutterDiv = window.document.getElementById("code-annotation-line-highlight-gutter");
            if (gutterDiv === null) {
              gutterDiv = window.document.createElement("div");
              gutterDiv.setAttribute("id", "code-annotation-line-highlight-gutter");
              gutterDiv.style.position = 'absolute';
              const codeCell = window.document.getElementById(targetCell);
              const gutter = codeCell.querySelector('.code-annotation-gutter');
              gutter.appendChild(gutterDiv);
            }
            gutterDiv.style.top = top - 2 + "px";
            gutterDiv.style.height = height + 4 + "px";
          }
          selectedAnnoteEl = annoteEl;
        }
      };
      const unselectCodeLines = () => {
        const elementsIds = ["code-annotation-line-highlight", "code-annotation-line-highlight-gutter"];
        elementsIds.forEach((elId) => {
          const div = window.document.getElementById(elId);
          if (div) {
            div.remove();
          }
        });
        selectedAnnoteEl = undefined;
      };
        // Handle positioning of the toggle
    window.addEventListener(
      "resize",
      throttle(() => {
        elRect = undefined;
        if (selectedAnnoteEl) {
          selectCodeLines(selectedAnnoteEl);
        }
      }, 10)
    );
    function throttle(fn, ms) {
    let throttle = false;
    let timer;
      return (...args) => {
        if(!throttle) { // first call gets through
            fn.apply(this, args);
            throttle = true;
        } else { // all the others get throttled
            if(timer) clearTimeout(timer); // cancel #2
            timer = setTimeout(() => {
              fn.apply(this, args);
              timer = throttle = false;
            }, ms);
        }
      };
    }
      // Attach click handler to the DT
      const annoteDls = window.document.querySelectorAll('dt[data-target-cell]');
      for (const annoteDlNode of annoteDls) {
        annoteDlNode.addEventListener('click', (event) => {
          const clickedEl = event.target;
          if (clickedEl !== selectedAnnoteEl) {
            unselectCodeLines();
            const activeEl = window.document.querySelector('dt[data-target-cell].code-annotation-active');
            if (activeEl) {
              activeEl.classList.remove('code-annotation-active');
            }
            selectCodeLines(clickedEl);
            clickedEl.classList.add('code-annotation-active');
          } else {
            // Unselect the line
            unselectCodeLines();
            clickedEl.classList.remove('code-annotation-active');
          }
        });
      }
  const findCites = (el) => {
    const parentEl = el.parentElement;
    if (parentEl) {
      const cites = parentEl.dataset.cites;
      if (cites) {
        return {
          el,
          cites: cites.split(' ')
        };
      } else {
        return findCites(el.parentElement)
      }
    } else {
      return undefined;
    }
  };
  var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
  for (var i=0; i<bibliorefs.length; i++) {
    const ref = bibliorefs[i];
    const citeInfo = findCites(ref);
    if (citeInfo) {
      tippyHover(citeInfo.el, function() {
        var popup = window.document.createElement('div');
        citeInfo.cites.forEach(function(cite) {
          var citeDiv = window.document.createElement('div');
          citeDiv.classList.add('hanging-indent');
          citeDiv.classList.add('csl-entry');
          var biblioDiv = window.document.getElementById('ref-' + cite);
          if (biblioDiv) {
            citeDiv.innerHTML = biblioDiv.innerHTML;
          }
          popup.appendChild(citeDiv);
        });
        return popup.innerHTML;
      });
    }
  }
});
</script>
<nav class="page-navigation">
  <div class="nav-page nav-page-previous">
      <a href="./02-07-06-01-survival-analysis-standard-joint-model-r.html" class="pagination-link" aria-label="Standard (Shared Random Effects) Joint Model">
        <i class="bi bi-arrow-left-short"></i> <span class="nav-page-text">Standard (Shared Random Effects) Joint Model</span>
      </a>          
  </div>
  <div class="nav-page nav-page-next">
      <a href="./02-07-06-03-survival-analysis-causal-effects-r.html" class="pagination-link" aria-label="Causal Effects from Joint Models">
        <span class="nav-page-text">Causal Effects from Joint Models</span> <i class="bi bi-arrow-right-short"></i>
      </a>
  </div>
</nav>
</div> <!-- /content -->
<footer class="footer">
  <div class="nav-footer">
    <div class="nav-footer-left">
<p>© CC-By Zia Ahmed, Unversity at Buffalo 2025</p>
</div>   
    <div class="nav-footer-center">
      &nbsp;
    </div>
    <div class="nav-footer-right">
<p>This page is built with <a href="https://quarto.org/">Quarto</a>.</p>
</div>
  </div>
</footer>




</body></html>